## Современные стандарты PHP
***

## Пространства имен и автозагрузка
### Для начала про анонимную функцию:
1. Пример 1:
~~~php
echo (function($x, $y) {
    return $x + $y;
})(2, 3);
~~~
2. Пример 2:
~~~php
$sum = function($x, $y) {
    return $x + $y;
};

echo $sum(2, 3);
~~~
В переменной содержится не результат выполнения функции, а сама по себу функция, ее код.

Разница между статическими и анонимными функциями только во времени, когда они создаются.

Обычная функция создается при компиляции, сразу размещается в память и ждет своего часа, для вызова.

А анонимная функция создается при исполнении программы (в той строчке кода где написано начинаем под нее память
выделять, компилировать ее код, класть в память и вызывать потом).

~~~php
$sum = function($x, $y) {
    return $x + $y;
};

$diff = function($x, $y) {
    return $x - $y;
};

function calc($x, $y, $op) {
    return $op($x, $y);
}

echo calc(2, 3, $sum);
~~~

~~~php
$arr = [1, 3, 4];

$res = array_map(function ($x) {
    return $x * 2;
}, $arr);

var_dump($res); // 2, 6, 8
~~~
___


## Пространства имен - своеобразная "папка" в которой может находиться класс.
В функцию автозагрузки будет передано ПОЛНОЕ имя класса, включая пространство имен от корневого.
~~~php
spl_autoload_register(function ($class) {
    require __DIR__ . '/../' . str_replace('\\', '/', $class) . '.php';
});
~~~

Задача: проект состоит из нескольких частей, каждая из них - со своей автозагрузкой.

Задача решается так называемой "цепочкой автозагрузки".

> spl_autoload_register(callable $autoload);

Функция из spl. Регистрирует заданную функцию в очереди в качестве реализации автозагрузки. Она создает очередь из функций
автозагрузки в порядке их определения в скрипте.

Очередь автозагрузки - это механизм, который позволяет зарегистрировать несколько функций автозагрузки, так что для каждого
класса, если он не найден, будет вызываться первая, вторая, и т.д. пока класс не найден.

~~~php
function my_autoload($class) {
    ...
}

spl_autoload_register('my_autoload');
spl_autoload_register(function ($class) {
    ...
});
~~~
___

## PSR
### PSR - это стандарты, обязательные для соблюдения всем программистами на PHP:
- PSR-1 - Базовый стандарт кодирования;
- PSR-12 - Руководство по стилю кода;
- PSR-3 - Интерфейс регистратора LoggerInterface;
- PSR-4 - Стандарт автозагрузки;
- PSR-6 - Интерфейс кэширования;
- PSR-7 - Интерфейсы для протокола HTTP;
___


## Composer
### Composer - инструмент для управления зависимостями в приложениях PHP.
- Поместить в корень проекта файл composer.json;
- Описать в нем зависимости - какие пакеты вы хотите использовать в своем проекте;
- Команда
> composer install
> или composer update
- Подключить к проекту файл
> vendor/autoload.php


### Что важно знать о Composer:
- Есть каталог пакетов, называется [Packagist](https://packagist.org)
- В нем собраны десятки тысяч пакетов, от библиотеки в один класс и до больших фреймворков;
- Можно оформить свой код, как пакет и выложить на Packagist;
- Однако пакет можно включить в проект и без каталога - например, напрямую через GitHub;
- Важная часть composer - управление версиями пакетов. И команда composer update;
- Composer создает локальный кэш пакетов, а не качает их каждый раз.