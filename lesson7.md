## Объектно-ориентированный подход
***

## Класс, как тип
### Класс - это тип объектов:
- Все объекты в php имеют тип object:
~~~php
$obj = new SomeClass();
echo gettype($obj); // object
~~~
- Однако, каждый класс можно рассматривать тоже как некий тип данных:
~~~php
$user = new User();
echo get_class($user); // User
~~~
- В php существует специальный оператор для проверки того, является ли объект объектом заданного класса:
~~~php
if ($obj instanceof $User) {
    ...
}
~~~
Даст true если имя класса будет одним из предков класса данного объекта. Проверяет, является ли выражение слева объектом того класса, который указан справа или любого его предка.
- Тайп-хинтинг - это указание типа аргумента. Можно указать str, int, float, bool, array, а можно имя класса, т.е. класс по сути дела созданный нами тип.
~~~php
function sendMail(User $user, $msg) {
    ...
}
~~~
Вызов такой функции будет успешен, если аргумент $user - объект класса User (или класса-наследника), если передать что-то другое - возникнет фатальная ошибка.
- Тайп-хинтинг позволяет контролировать ход выполнения программы и использовать принцип ООП
> Старайтесь всегда передавать объекты, а не их куски. Не передавайте в функцию email пользователя, передайте всего пользователя целиком. А функция сама решит какие конкретно данные от объекта ей нужно.

Это принцип ООП, когда мы возвращаем из функции объекты, и в функцию передаем тоже объекты. Архитектура должна быть построена таким образом, что между частями программы перемещаются объекты.
___


## Модели данных. ORM.
### Объекты принято использовать в качестве МОДЕЛЕЙ данных:

ORM - Object Relational Mapping, или, иначе говоря, принцип отображения объектов реального мира (и их связей) на объекты языка программирования.
ORM вещь, которая говорит о том, что если программа работает с объектами реального мира, заведите класс для таких объектов и сами их представляйте объектами.

1-й постулат ORM: данные представлены не в виде строк, чисел и т.д., а в виде объектов соответствующих классов. Для каждой сущности в реальном мире существует класс.

ООП прекрасно подходит для реализации шаблона проектирования ORM:
- Класс описывает какие объекты данных могут быть;
- Сами данные представлены объектами заданных классов;
- Сразу можно определить "поведение данных" в виде методов этих объектов;
- Методы, возвращающие данные, должны возвращать массивы объектов нужного класса;
- Методы, принимающие данные - принимать объекты нужного класса;
- Допускается создание "мета-объектов", например класса GuestBook;
- Не бояться "копирования", объекты передаются по ссылке.
___


## Отделение представления от кода.
### Правильно разделять представление и бизнес-логику:
1. Сверстать шаблон страницы. Обычный HTML;
2. Определить, какие данные будут ей переданы;
3. Подготовить данные, получив их от моделей;
4. Передать (в простейшем случае - просто include);
5. И, наконец, создать специальный объект, который будет управлять представлением:
- Хранить в себе данные для него; 
- Отображать заданный шаблон с этими данными.
___


## Буфер вывода
### Все, что мы выводим - уже нельзя вернуть назад...
Например:
~~~php
echo 'hello';
~~~

В таком случае все, что мы выводим, непосредственно отправляется сразу клиенту.

##### Однако в php есть способ взять вывод в "буфер", чтобы потом с ним работать:
~~~php
ob_start();                 // Ставим дамбу
echo 'Hello';
$out = ob_get_contents();   // Забрали к себе в переменную
ob_end_clean();             // Дамбу сносит, все накопленное уничтожает.
~~~